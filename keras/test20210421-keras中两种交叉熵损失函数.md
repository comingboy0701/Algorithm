```python
import tensorflow as tf
import numpy as np

def sigmoid(x):
    return 1.0/(1+np.exp(-x))

y = np.array([[1,0,0],[0,1,0],[0,1,0],[0,1,0],[0,1,0]])
logits = np.array([[12,3,2],[3,10,1],[1,2,5],[4,6.5,1.2],[3,6,1]])
y_pred = sigmoid(logits)

BCE1 = -y*np.log(y_pred)-(1-y)*np.log(1-y_pred)
print(BCE1)
print(y_pred)
```

    [[6.14419348e-06 3.04858735e+00 2.12692801e+00]
     [3.04858735e+00 4.53988992e-05 1.31326169e+00]
     [1.31326169e+00 1.26928011e-01 5.00671535e+00]
     [4.01814993e+00 1.50231016e-03 1.46328247e+00]
     [3.04858735e+00 2.47568514e-03 1.31326169e+00]]
    [[0.99999386 0.95257413 0.88079708]
     [0.95257413 0.9999546  0.73105858]
     [0.73105858 0.88079708 0.99330715]
     [0.98201379 0.99849882 0.76852478]
     [0.95257413 0.99752738 0.73105858]]



```python
sess =tf.Session()
y = np.array(y).astype(np.float64)
BCE2 = sess.run(tf.nn.sigmoid_cross_entropy_with_logits(labels=y,logits=logits))

print(BCE2)
print(y_pred)
```

    [[6.14419348e-06 3.04858735e+00 2.12692801e+00]
     [3.04858735e+00 4.53988992e-05 1.31326169e+00]
     [1.31326169e+00 1.26928011e-01 5.00671535e+00]
     [4.01814993e+00 1.50231016e-03 1.46328247e+00]
     [3.04858735e+00 2.47568514e-03 1.31326169e+00]]
    [[0.99999386 0.95257413 0.88079708]
     [0.95257413 0.9999546  0.73105858]
     [0.73105858 0.88079708 0.99330715]
     [0.98201379 0.99849882 0.76852478]
     [0.95257413 0.99752738 0.73105858]]



```python
def softmax(x):
    sum_raw = np.sum(np.exp(x),axis=-1)
    x1 = np.ones(np.shape(x))
    for i in range(np.shape(x)[0]):
        x1[i] = np.exp(x[i])/sum_raw[i]
    return x1

y_pred = softmax(logits)

CE1 = -np.sum(y*np.log(y_pred),-1)

CE2 = sess.run(tf.nn.softmax_cross_entropy_with_logits_v2(labels=y,logits=logits))

print(y_pred)
print(CE1)
print(CE2)
```

    [[9.99831219e-01 1.23388975e-04 4.53922671e-05]
     [9.10938878e-04 9.98965779e-01 1.23282171e-04]
     [1.71478255e-02 4.66126226e-02 9.36239552e-01]
     [7.55098575e-02 9.19898383e-01 4.59175917e-03]
     [4.71234165e-02 9.46499123e-01 6.37746092e-03]]
    [1.68795487e-04 1.03475622e-03 3.06588390e+00 8.34920680e-02
     5.49852354e-02]
    [1.68795487e-04 1.03475622e-03 3.06588390e+00 8.34920680e-02
     5.49852354e-02]



```python

```
